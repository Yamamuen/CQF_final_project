{
	"name": "IndexError",
	"message": "tuple index out of range",
	"stack": "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[1;31mIndexError\u001b[0m                                Traceback (most recent call last)\n\u001b[1;32mc:\\Users\\enzoy\\Desktop\\CQF_final_project\\DL.ipynb CÃ©lula: 11\u001b[0m in \u001b[0;36m<cell line: 13>\u001b[1;34m()\u001b[0m\n\u001b[0;32m      <a href='vscode-notebook-cell:/c%3A/Users/enzoy/Desktop/CQF_final_project/DL.ipynb#X25sZmlsZQ%3D%3D?line=1'>2</a>\u001b[0m params \u001b[39m=\u001b[39m {\u001b[39m'\u001b[39m\u001b[39mlr\u001b[39m\u001b[39m'\u001b[39m: (\u001b[39m0.01\u001b[39m, \u001b[39m0.001\u001b[39m),\n\u001b[0;32m      <a href='vscode-notebook-cell:/c%3A/Users/enzoy/Desktop/CQF_final_project/DL.ipynb#X25sZmlsZQ%3D%3D?line=2'>3</a>\u001b[0m         \u001b[39m'\u001b[39m\u001b[39mneurons\u001b[39m\u001b[39m'\u001b[39m: [\u001b[39m8\u001b[39m, \u001b[39m64\u001b[39m, \u001b[39m128\u001b[39m], \n\u001b[0;32m      <a href='vscode-notebook-cell:/c%3A/Users/enzoy/Desktop/CQF_final_project/DL.ipynb#X25sZmlsZQ%3D%3D?line=3'>4</a>\u001b[0m         \u001b[39m'\u001b[39m\u001b[39mdropout\u001b[39m\u001b[39m'\u001b[39m: [\u001b[39m0\u001b[39m, \u001b[39m0.3\u001b[39m, \u001b[39m0.5\u001b[39m],\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m      <a href='vscode-notebook-cell:/c%3A/Users/enzoy/Desktop/CQF_final_project/DL.ipynb#X25sZmlsZQ%3D%3D?line=7'>8</a>\u001b[0m         \u001b[39m'\u001b[39m\u001b[39mactivation\u001b[39m\u001b[39m'\u001b[39m: [\u001b[39m'\u001b[39m\u001b[39mrelu\u001b[39m\u001b[39m'\u001b[39m,\u001b[39m'\u001b[39m\u001b[39melu\u001b[39m\u001b[39m'\u001b[39m],\n\u001b[0;32m      <a href='vscode-notebook-cell:/c%3A/Users/enzoy/Desktop/CQF_final_project/DL.ipynb#X25sZmlsZQ%3D%3D?line=8'>9</a>\u001b[0m         \u001b[39m'\u001b[39m\u001b[39mdense_neurons\u001b[39m\u001b[39m'\u001b[39m: [\u001b[39m8\u001b[39m, \u001b[39m16\u001b[39m, \u001b[39m64\u001b[39m]}\n\u001b[0;32m     <a href='vscode-notebook-cell:/c%3A/Users/enzoy/Desktop/CQF_final_project/DL.ipynb#X25sZmlsZQ%3D%3D?line=9'>10</a>\u001b[0m         \u001b[39m# 'window':[5,10,21,50]\u001b[39;00m\n\u001b[0;32m     <a href='vscode-notebook-cell:/c%3A/Users/enzoy/Desktop/CQF_final_project/DL.ipynb#X25sZmlsZQ%3D%3D?line=10'>11</a>\u001b[0m \n\u001b[0;32m     <a href='vscode-notebook-cell:/c%3A/Users/enzoy/Desktop/CQF_final_project/DL.ipynb#X25sZmlsZQ%3D%3D?line=11'>12</a>\u001b[0m \u001b[39m# Scanning for best hyperparameters with Talos\u001b[39;00m\n\u001b[1;32m---> <a href='vscode-notebook-cell:/c%3A/Users/enzoy/Desktop/CQF_final_project/DL.ipynb#X25sZmlsZQ%3D%3D?line=12'>13</a>\u001b[0m scan \u001b[39m=\u001b[39m talos\u001b[39m.\u001b[39;49mScan(x \u001b[39m=\u001b[39;49m x_train, y \u001b[39m=\u001b[39;49m y_train, x_val \u001b[39m=\u001b[39;49m x_test, y_val \u001b[39m=\u001b[39;49m y_test, params \u001b[39m=\u001b[39;49m params, model \u001b[39m=\u001b[39;49m lstm_model,experiment_name \u001b[39m=\u001b[39;49m \u001b[39m'\u001b[39;49m\u001b[39mlstm_model_val\u001b[39;49m\u001b[39m'\u001b[39;49m)\n\nFile \u001b[1;32m~\\AppData\\Roaming\\Python\\Python39\\site-packages\\talos\\scan\\Scan.py:205\u001b[0m, in \u001b[0;36mScan.__init__\u001b[1;34m(self, x, y, params, model, experiment_name, x_val, y_val, val_split, multi_input, random_method, seed, performance_target, fraction_limit, round_limit, time_limit, boolean_limit, reduction_method, reduction_interval, reduction_window, reduction_threshold, reduction_metric, minimize_loss, disable_progress_bar, print_params, clear_session, save_weights, save_models)\u001b[0m\n\u001b[0;32m    203\u001b[0m \u001b[39m# start runtime\u001b[39;00m\n\u001b[0;32m    204\u001b[0m \u001b[39mfrom\u001b[39;00m \u001b[39m.\u001b[39;00m\u001b[39mscan_run\u001b[39;00m \u001b[39mimport\u001b[39;00m scan_run\n\u001b[1;32m--> 205\u001b[0m scan_run(\u001b[39mself\u001b[39;49m)\n\nFile \u001b[1;32m~\\AppData\\Roaming\\Python\\Python39\\site-packages\\talos\\scan\\scan_run.py:9\u001b[0m, in \u001b[0;36mscan_run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m      6\u001b[0m \u001b[39mfrom\u001b[39;00m \u001b[39mtqdm\u001b[39;00m \u001b[39mimport\u001b[39;00m tqdm\n\u001b[0;32m      8\u001b[0m \u001b[39mfrom\u001b[39;00m \u001b[39m.\u001b[39;00m\u001b[39mscan_prepare\u001b[39;00m \u001b[39mimport\u001b[39;00m scan_prepare\n\u001b[1;32m----> 9\u001b[0m \u001b[39mself\u001b[39m \u001b[39m=\u001b[39m scan_prepare(\u001b[39mself\u001b[39;49m)\n\u001b[0;32m     11\u001b[0m \u001b[39m# initiate the progress bar\u001b[39;00m\n\u001b[0;32m     12\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mpbar \u001b[39m=\u001b[39m tqdm(total\u001b[39m=\u001b[39m\u001b[39mlen\u001b[39m(\u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparam_object\u001b[39m.\u001b[39mparam_index),\n\u001b[0;32m     13\u001b[0m                  disable\u001b[39m=\u001b[39m\u001b[39mself\u001b[39m\u001b[39m.\u001b[39mdisable_progress_bar)\n\nFile \u001b[1;32m~\\AppData\\Roaming\\Python\\Python39\\site-packages\\talos\\scan\\scan_prepare.py:27\u001b[0m, in \u001b[0;36mscan_prepare\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     25\u001b[0m     \u001b[39m# create the parameter object and move to self\u001b[39;00m\n\u001b[0;32m     26\u001b[0m     \u001b[39mfrom\u001b[39;00m \u001b[39m.\u001b[39;00m\u001b[39m.\u001b[39;00m\u001b[39mparameters\u001b[39;00m\u001b[39m.\u001b[39;00m\u001b[39mParamSpace\u001b[39;00m \u001b[39mimport\u001b[39;00m ParamSpace\n\u001b[1;32m---> 27\u001b[0m     \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparam_object \u001b[39m=\u001b[39m ParamSpace(params\u001b[39m=\u001b[39;49m\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mparams,\n\u001b[0;32m     28\u001b[0m                                    param_keys\u001b[39m=\u001b[39;49m\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_param_dict_keys,\n\u001b[0;32m     29\u001b[0m                                    random_method\u001b[39m=\u001b[39;49m\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mrandom_method,\n\u001b[0;32m     30\u001b[0m                                    fraction_limit\u001b[39m=\u001b[39;49m\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mfraction_limit,\n\u001b[0;32m     31\u001b[0m                                    round_limit\u001b[39m=\u001b[39;49m\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mround_limit,\n\u001b[0;32m     32\u001b[0m                                    time_limit\u001b[39m=\u001b[39;49m\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mtime_limit,\n\u001b[0;32m     33\u001b[0m                                    boolean_limit\u001b[39m=\u001b[39;49m\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mboolean_limit)\n\u001b[0;32m     35\u001b[0m \u001b[39m# handle the case when self.params already is ParamSpace object\u001b[39;00m\n\u001b[0;32m     36\u001b[0m \u001b[39melif\u001b[39;00m \u001b[39m'\u001b[39m\u001b[39mtalos.parameters.ParamSpace.ParamSpace\u001b[39m\u001b[39m'\u001b[39m \u001b[39min\u001b[39;00m \u001b[39mstr\u001b[39m(\u001b[39mtype\u001b[39m(\u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparams)):\n\nFile \u001b[1;32m~\\AppData\\Roaming\\Python\\Python39\\site-packages\\talos\\parameters\\ParamSpace.py:32\u001b[0m, in \u001b[0;36mParamSpace.__init__\u001b[1;34m(self, params, param_keys, random_method, fraction_limit, round_limit, time_limit, boolean_limit)\u001b[0m\n\u001b[0;32m     29\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mround_counter \u001b[39m=\u001b[39m \u001b[39m0\u001b[39m\n\u001b[0;32m     31\u001b[0m \u001b[39m# handle tuple conversion to discrete values\u001b[39;00m\n\u001b[1;32m---> 32\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mp \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_param_input_conversion()\n\u001b[0;32m     34\u001b[0m \u001b[39m# create list of list from the params dictionary\u001b[39;00m\n\u001b[0;32m     35\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_params_temp \u001b[39m=\u001b[39m [\u001b[39mlist\u001b[39m(\u001b[39mself\u001b[39m\u001b[39m.\u001b[39mp[key]) \u001b[39mfor\u001b[39;00m key \u001b[39min\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparam_keys]\n\nFile \u001b[1;32m~\\AppData\\Roaming\\Python\\Python39\\site-packages\\talos\\parameters\\ParamSpace.py:68\u001b[0m, in \u001b[0;36mParamSpace._param_input_conversion\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     64\u001b[0m \u001b[39mfor\u001b[39;00m param \u001b[39min\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparam_keys:\n\u001b[0;32m     65\u001b[0m \n\u001b[0;32m     66\u001b[0m     \u001b[39m# deal with range (tuple) values\u001b[39;00m\n\u001b[0;32m     67\u001b[0m     \u001b[39mif\u001b[39;00m \u001b[39misinstance\u001b[39m(\u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparams[param], \u001b[39mtuple\u001b[39m):\n\u001b[1;32m---> 68\u001b[0m         out[param] \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_param_range_expansion(\u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mparams[param])\n\u001b[0;32m     70\u001b[0m     \u001b[39m# deal with range (list) values\u001b[39;00m\n\u001b[0;32m     71\u001b[0m     \u001b[39melif\u001b[39;00m \u001b[39misinstance\u001b[39m(\u001b[39mself\u001b[39m\u001b[39m.\u001b[39mparams[param], \u001b[39mlist\u001b[39m):\n\nFile \u001b[1;32m~\\AppData\\Roaming\\Python\\Python39\\site-packages\\talos\\parameters\\ParamSpace.py:113\u001b[0m, in \u001b[0;36mParamSpace._param_range_expansion\u001b[1;34m(self, param_values)\u001b[0m\n\u001b[0;32m    111\u001b[0m start \u001b[39m=\u001b[39m param_values[\u001b[39m0\u001b[39m]\n\u001b[0;32m    112\u001b[0m end \u001b[39m=\u001b[39m param_values[\u001b[39m1\u001b[39m]\n\u001b[1;32m--> 113\u001b[0m steps \u001b[39m=\u001b[39m param_values[\u001b[39m2\u001b[39;49m]\n\u001b[0;32m    115\u001b[0m out \u001b[39m=\u001b[39m np\u001b[39m.\u001b[39marange(start, end, (end \u001b[39m-\u001b[39m start) \u001b[39m/\u001b[39m steps, dtype\u001b[39m=\u001b[39m\u001b[39mfloat\u001b[39m)\n\u001b[0;32m    117\u001b[0m \u001b[39m# inputs are all ints\u001b[39;00m\n\n\u001b[1;31mIndexError\u001b[0m: tuple index out of range"
}